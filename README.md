# Одноразовые ссылки API

Этот проект предоставляет сервис для создания и проверки одноразовых ссылок с использованием FastAPI и Pydantic. Сервис поддерживает функциональность создания одноразовых ссылок с ограниченным временем действия, а также их проверку с автоматическим уничтожением при успешной валидации.

## Структура проекта

Проект использует следующую структуру:
```text
.
├── .dockerignore            # Список файлов и директорий, которые игнорируются при создании Docker-образа
├── .env.example             # Пример файла .env, где указаны все необходимые переменные окружения
├── .python-version          # Указание на версию Python для использования в виртуальном окружении
├── Dockerfile               # Dockerfile для создания образа приложения
├── README.md                # Этот файл с документацией
├── docker-compose.yaml      # Конфигурация для Docker Compose
├── pyproject.toml           # Конфигурация зависимостей и настроек проекта (для Poetry или других менеджеров зависимостей)
├── src                      # Основной код проекта
│   ├── dependencies         # Модуль с зависимостями, например, с функцией для получения IP клиента
│   │   ├── __init__.py
│   │   └── get_client_ip.py # Функция для получения IP клиента из запроса
│   ├── docs                 # Документация API, описание возможных ответов и статусов
│   │   ├── __init__.py
│   │   └── responses.py     # Описание всех возможных ответов на эндпоинтах
│   ├── exceptions           # Кастомные исключения для обработки ошибок (например, для доступа или ссылок)
│   │   ├── __init__.py
│   │   ├── access.py        # Исключение для отказа в доступе
│   │   └── links.py         # Исключение для обработки ошибок с одноразовыми ссылками
│   ├── main.py              # Основной файл с настройкой FastAPI приложения и подключением маршрутов
│   ├── routes               # Все маршруты (эндпоинты) для работы с API
│   │   ├── __init__.py
│   │   ├── health.py        # Эндпоинт для проверки состояния сервиса (health check)
│   │   └── links.py         # Эндпоинты для создания и проверки одноразовых ссылок
│   ├── schemas              # Pydantic схемы для валидации запросов и ответов
│   │   ├── __init__.py
│   │   └── link.py          # Схемы для создания и проверки одноразовых ссылок
│   └── settings.py          # Конфигурации и загрузка переменных окружения
└── uv.lock                  
```

## Установка

### 1. Клонирование репозитория

Для начала вам нужно клонировать репозиторий:

```shell
git clone https://github.com/Eytes/simple-one-time-links.git
cd one-time-links-api
```

### 2. Создание файла .env

Создайте файл .env для хранения конфиденциальных данных, например, для списка доверенных IP-адресов и других переменных окружения.

Пример содержания файла .env:

```shell
TRUSTED_IPS="192.168.1.1,192.168.1.2"
HTTP_HOST_URL="http://localhost"
LINK_TTL="0:00:30" # 30 sec
```

### 3. Запуск сервиса

```shell
docker-compose up --build
```

Теперь сервис будет доступен по адресу http://localhost
Документация http://localhost/api/docs.
